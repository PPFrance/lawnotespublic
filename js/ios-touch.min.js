(function(d){function k(a,b){this.dragData={};this.dragDataTypes=[];this.dragImageWebKitTransform=this.dragImageTransform=this.dragImage=null;this.el=b||a.target;f("dragstart");this.dispatchDragStart();this.createDragImage();this.listen()}function r(a){var b=a.target;do if(!0===b.draggable){if(!b.hasAttribute("draggable")&&"a"==b.tagName.toLowerCase()){var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,b.ownerDocument.defaultView,1,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,
a.altKey,a.shiftKey,a.metaKey,0,null);b.dispatchEvent(c);f("Simulating click to anchor")}a.preventDefault();new k(a,b)}while((b=b.parentNode)&&b!==d.body)}function m(a,b){var c=b.changedTouches[0];return d.elementFromPoint(c[g+"X"],c[g+"Y"])}function l(a,b,c,e){e&&(c=c.bind(e));a.addEventListener(b,c);return{off:function(){return a.removeEventListener(b,c)}}}function t(a,b,c,e){function d(e){c(e);return a.removeEventListener(b,d)}e&&(c=c.bind(e));return a.addEventListener(b,d)}function n(a,b){if(1==
a.nodeType){b.removeAttribute("id");b.removeAttribute("class");b.removeAttribute("style");b.removeAttribute("draggable");for(var c=window.getComputedStyle(a),d=0;d<c.length;d++){var h=c[d];b.style.setProperty(h,c.getPropertyValue(h),c.getPropertyPriority(h))}b.style.pointerEvents="none"}if(a.hasChildNodes())for(c=0;c<a.childNodes.length;c++)n(a.childNodes[c],b.childNodes[c])}function f(a){console.log(a)}function p(a){return 0===a.length?0:a.reduce(function(a,c){return c+a},0)/a.length}function q(){}
var f=q,g;k.prototype={listen:function(){function a(){f("cleanup");this.dragDataTypes=[];null!==this.dragImage&&(this.dragImage.parentNode.removeChild(this.dragImage),this.dragImageWebKitTransform=this.dragImageTransform=this.dragImage=null);this.el=this.dragData=null;return[b,c,e].forEach(function(a){return a.off()})}var b=l(d,"touchmove",this.move,this),c=l(d,"touchend",function(b){this.dragend(b,b.target);a.call(this)},this),e=l(d,"touchcancel",a,this)},move:function(a){var b=[],c=[];[].forEach.call(a.changedTouches,
function(a){b.push(a.pageX);c.push(a.pageY)});var d=p(b)-parseInt(this.dragImage.offsetWidth,10)/2,f=p(c)-parseInt(this.dragImage.offsetHeight,10)/2;this.translateDragImage(d,f);this.synthesizeEnterLeave(a)},translateDragImage:function(a,b){var c=" translate("+a+"px,"+b+"px)";null!==this.dragImageWebKitTransform&&(this.dragImage.style["-webkit-transform"]=this.dragImageWebKitTransform+c);null!==this.dragImageTransform&&(this.dragImage.style.transform=this.dragImageTransform+c)},synthesizeEnterLeave:function(a){var b=
m(this.el,a);b!=this.lastEnter&&(this.lastEnter&&this.dispatchLeave(a),(this.lastEnter=b)&&this.dispatchEnter(a));this.lastEnter&&this.dispatchOver(a)},dragend:function(a){f("dragend");this.lastEnter&&this.dispatchLeave(a);var b=m(this.el,a);b?(f("found drop target "+b.tagName),this.dispatchDrop(b,a)):f("no drop target");a=d.createEvent("Event");a.initEvent("dragend",!0,!0);this.el.dispatchEvent(a)},dispatchDrop:function(a,b){var c=d.createEvent("Event");c.initEvent("drop",!0,!0);var e=b.changedTouches[0],
h=e[g+"Y"];c.offsetX=e[g+"X"]-a.x;c.offsetY=h-a.y;c.dataTransfer={types:this.dragDataTypes,getData:function(a){return this.dragData[a]}.bind(this)};c.preventDefault=function(){}.bind(this);t(d,"drop",function(){f("drop event not canceled")},this);a.dispatchEvent(c)},dispatchEnter:function(a){var b=d.createEvent("Event");b.initEvent("dragenter",!0,!0);b.dataTransfer={types:this.dragDataTypes,getData:function(a){return this.dragData[a]}.bind(this)};a=a.changedTouches[0];b.pageX=a.pageX;b.pageY=a.pageY;
this.lastEnter.dispatchEvent(b)},dispatchOver:function(a){var b=d.createEvent("Event");b.initEvent("dragover",!0,!0);b.dataTransfer={types:this.dragDataTypes,getData:function(a){return this.dragData[a]}.bind(this)};a=a.changedTouches[0];b.pageX=a.pageX;b.pageY=a.pageY;this.lastEnter.dispatchEvent(b)},dispatchLeave:function(a){var b=d.createEvent("Event");b.initEvent("dragleave",!0,!0);b.dataTransfer={types:this.dragDataTypes,getData:function(a){return this.dragData[a]}.bind(this)};a=a.changedTouches[0];
b.pageX=a.pageX;b.pageY=a.pageY;this.lastEnter.dispatchEvent(b);this.lastEnter=null},dispatchDragStart:function(){var a=d.createEvent("Event");a.initEvent("dragstart",!0,!0);a.dataTransfer={setData:function(a,c){this.dragData[a]=c;-1==this.dragDataTypes.indexOf(a)&&(this.dragDataTypes[this.dragDataTypes.length]=a);return c}.bind(this),dropEffect:"move"};this.el.dispatchEvent(a)},createDragImage:function(){this.dragImage=this.el.cloneNode(!0);n(this.el,this.dragImage);this.dragImage.style.opacity=
"0.5";this.dragImage.style.position="absolute";this.dragImage.style.left="0px";this.dragImage.style.top="0px";this.dragImage.style.zIndex="999999";var a=this.dragImage.style.transform;"undefined"!==typeof a&&(this.dragImageTransform="","none"!=a&&(this.dragImageTransform=a.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,"")));a=this.dragImage.style["-webkit-transform"];"undefined"!==typeof a&&(this.dragImageWebKitTransform="","none"!=a&&(this.dragImageWebKitTransform=a.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,
"")));this.translateDragImage(-9999,-9999);d.body.appendChild(this.dragImage)}};(function(a){a=a||{};g=navigator.userAgent.match(/OS [1-4](?:_\d+)+ like Mac/)?"page":"client";var b=d.createElement("div"),b=!("draggable"in b||"ondragstart"in b&&"ondrop"in b)||/iPad|iPhone|iPod|Android/.test(navigator.userAgent);f((b?"":"not ")+"patching html5 drag drop");b&&(a.enableEnterLeave||(k.prototype.synthesizeEnterLeave=q),d.addEventListener("touchstart",r))})(window.iosDragDropShim)})(document);
